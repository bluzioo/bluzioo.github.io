<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>loadbalancer - Tag - Bluz Space</title>
        <link>https://bluzioo.github.io/tags/loadbalancer/</link>
        <description>loadbalancer - Tag - Bluz Space</description>
        <generator>Hugo -- gohugo.io</generator><language>en</language><managingEditor>bluz.mao@outlook.com (maozw)</managingEditor>
            <webMaster>bluz.mao@outlook.com (maozw)</webMaster><copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright><lastBuildDate>Tue, 10 Aug 2021 15:38:37 &#43;0800</lastBuildDate><atom:link href="https://bluzioo.github.io/tags/loadbalancer/" rel="self" type="application/rss+xml" /><item>
    <title>Kubernetes 裸金属环境负载均衡器 - MetalLB</title>
    <link>https://bluzioo.github.io/metallb/</link>
    <pubDate>Tue, 10 Aug 2021 15:38:37 &#43;0800</pubDate>
    <author>Author</author>
    <guid>https://bluzioo.github.io/metallb/</guid>
    <description><![CDATA[背景 Kubernetes service对外提供服务的方式有NodePort/ClusterIP/Ingress/LoadBalancer。NodePort以集群内主机绑定随机或自定义端口方式暴露服务，存在单点问题，不会用于生产环境。Ingress基于7层协议，只支持http/https，搭配Ingress Controller再前置LVS-keepalived或LoadBalancer才可对外提供高可用服务。
在公有云的K8S集群通常使用云厂商的LB对外暴露的方式，如AWS的ELB。由于K8S本身不提供LB服务，就需解决自建方式（裸金属环境）的负载均衡器缺失问题。
裸金属环境的负载均衡器开源解决方案：
 MetalLB OpenELB （原PorterLB）  以下对MetalLB进行展开
概念 MetalLB具备两项功能：address allocation和external announcement
Address Allocation MetalLB支持地址分配，前提是配置好IP池。面向内网的集群，即分配好内网IP段，而面向公网的，也可列举可用的公网IP列表。
如果不指定service的spec.loadbalancerIP，metalLB则会从IP池随机分配给LoadBalancer型的service。
External Announcement 分配了的LB IP对外又是怎么被发现及访问到？MetalLB提供了两种模式：Layer 2和BGP。
在Layer 2模式下，可指定几台集群内主机作为响应LB IP的地址发现（ARP for IPv4, NDP for IPv6）。
在BGP模式下，需要上层路由器支持BGP协议，MetalLB与路由器建立BGP session，更新LB IP的路由信息。
部署 环境要求  Kubernetes version &gt; 1.13.0, 集群没有负载均衡器 集群网络兼容MetalLB，兼容清单https://metallb.universe.tf/installation/network-addons/ 空闲的IP或IP段可供MetalLB分配 BGP模式需要支持BGP协议的上层路由器 7946端口在节点间开放  测试环境    组件 描述     系统 centos7   内核 5.13.0-1.el7.elrepo.x86_64   kubernetes v1.19.12   cilium v1.]]></description>
</item></channel>
</rss>
